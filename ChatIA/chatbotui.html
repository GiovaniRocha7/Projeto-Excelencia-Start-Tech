<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat - ExcelencIA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="chat.css">
    <link rel="shortcut icon" type="image/x-icon" href="../assets/tema escuro/excelencia texto ia.PNG">
</head>

<body>
    <div class="chat-container">
        <!-- OVERLAY -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- SIDEBAR -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img class="logo-excelencia" src="../assets/tema escuro/logo-excelencia.PNG" alt="ExcelencIA">
                <button class="sidebar-close-btn" id="sidebarCloseBtn" title="Fechar menu">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <button class="back-home-btn" id="backHomeBtn" title="Voltar para página inicial">
                <i class="fas fa-arrow-left"></i>
                Voltar
            </button>

            <button class="new-chat-btn" id="newChatBtn">
                <i class="fas fa-plus"></i>
                Nova Conversa
            </button>

            <div class="chat-history" id="chatHistory">
                <div class="chat-item active" data-chat-id="1">Entrevista de Desenvolvedor</div>
                <div class="chat-item" data-chat-id="2">Dicas de apresentação</div>
                <div class="chat-item" data-chat-id="3">Perguntas sobre liderança</div>
                <div class="chat-item" data-chat-id="4">Preparação para RH</div>
                <div class="chat-item" data-chat-id="5">Feedback da última simulação</div>
            </div>
        </div>

        <!-- MODAL DE SETUP (Aparece primeiro) -->
        <div class="setup-overlay" id="setupOverlay">
            <div class="setup-modal" id="setupModal">
                <div class="setup-content">
                    <div class="setup-header">
                        <h1>SIMULAÇÃO DE ENTREVISTA</h1>
                    </div>
                    <p class="setup-subtitle">Tipo de entrevista:</p>

                    <div class="setup-form">
                        <!-- Área Profissional -->
                        <div class="form-group">
                            <label for="professionalArea">Área profissional:</label>
                            <select id="professionalArea" class="form-select">
                                <option value="">Selecione uma área</option>
                                <option value="desenvolvimento">Desenvolvedor de Software</option>
                                <option value="marketing">Supervisor de Marketing</option>
                                <option value="vendas">Gerente de Vendas</option>
                                <option value="rh">Analista de RH</option>
                                <option value="design">Designer UX/UI</option>
                                <option value="dados">Analista de Dados</option>
                                <option value="produto">Product Manager</option>
                                <option value="financeiro">Analista Financeiro</option>
                            </select>
                        </div>

                        <!-- Nível de Dificuldade -->
                        <div class="form-group">
                            <label for="difficulty">Nível de dificuldade:</label>
                            <select id="difficulty" class="form-select">
                                <option value="facil">Fácil</option>
                                <option value="medio">Médio</option>
                                <option value="dificil">Difícil</option>
                                <option value="expert">Expert</option>
                            </select>
                        </div>

                        <!-- Tempo Estimado -->
                        <div class="form-group">
                            <label for="duration">Tempo estimado:</label>
                            <select id="duration" class="form-select">
                                <option value="15">15 min</option>
                                <option value="30" selected>30 min</option>
                                <option value="45">45 min</option>
                                <option value="60">60 min</option>
                            </select>
                        </div>

                        <!-- Tipo de Avaliação -->
                        <div class="form-group">
                            <label for="evaluationType">Tipo de Avaliação:</label>
                            <select id="evaluationType" class="form-select">
                                <option value="tecnica">Técnica</option>
                                <option value="comportamental">Comportamental</option>
                                <option value="mista">Mista</option>
                            </select>
                        </div>

                        <!-- Botão Iniciar -->
                        <button type="button" class="btn-start" id="startInterviewBtn">
                            <i class="fas fa-play"></i>
                            Iniciar Simulação
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MAIN CHAT (Escondido inicialmente) -->
        <div class="chat-main" id="chatMain" style="display: none;">
            <!-- HEADER -->
            <div class="chat-header">
                <button class="menu-toggle" id="menuToggle" title="Abrir menu">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-title" id="chatTitle">Simulação de Entrevista</div>
            </div>

            <!-- MESSAGES -->
            <div class="messages-area" id="messagesArea">
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="empty-text">Comece uma conversa</div>
                    <div class="empty-subtext">Digite sua primeira mensagem para iniciar</div>
                </div>
            </div>

            <!-- INPUT -->
            <div class="input-area">
                <form class="input-form" id="chatForm">
                    <div class="input-wrapper">
                        <input type="text" class="chat-input" id="messageInput"
                            placeholder="Escreva sua resposta aqui..." autocomplete="off">
                        <div class="input-actions">
                            <button type="button" class="action-btn" id="attachBtn" title="Anexar arquivo">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button type="button" class="action-btn" id="microphoneBtn" title="Microfone">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                    </div>
                    <button type="submit" class="send-btn" id="sendBtn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        /* =============================================== */
        /* ========== MODAL DE SETUP - INÍCIO ========== */
        /* =============================================== */
        
        // Elementos do modal de setup
        const setupOverlay = document.getElementById('setupOverlay');
        const setupModal = document.getElementById('setupModal');
        const chatMain = document.getElementById('chatMain');
        const startInterviewBtn = document.getElementById('startInterviewBtn');
        const professionalAreaSelect = document.getElementById('professionalArea');
        const difficultySelect = document.getElementById('difficulty');
        const durationSelect = document.getElementById('duration');
        const evaluationTypeSelect = document.getElementById('evaluationType');
        const chatTitleElement = document.getElementById('chatTitle');
        
        // Função para iniciar a entrevista
        startInterviewBtn.addEventListener('click', () => {
            // Validar se uma área foi selecionada
            if (!professionalAreaSelect.value) {
                alert('Por favor, selecione uma área profissional antes de continuar.');
                return;
            }
            
            // Coletar dados da simulação
            const simulationData = {
                area: professionalAreaSelect.options[professionalAreaSelect.selectedIndex].text,
                difficulty: difficultySelect.options[difficultySelect.selectedIndex].text,
                duration: durationSelect.value,
                evaluationType: evaluationTypeSelect.options[evaluationTypeSelect.selectedIndex].text
            };
            
            // Atualizar título do chat
            chatTitleElement.textContent = `Simulação de Entrevista - ${simulationData.area}`;
            
            // Esconder modal e mostrar chat
            setupOverlay.style.display = 'none';
            chatMain.style.display = 'flex';
            
            // Adicionar mensagem inicial da IA
            setTimeout(() => {
                addMessage(
                    `Olá! Bem-vindo à simulação de entrevista para ${simulationData.area}. ` +
                    `Esta é uma entrevista ${simulationData.evaluationType} de nível ${simulationData.difficulty}. ` +
                    `Vamos começar! Conte-me um pouco sobre você e sua experiência.`,
                    false
                );
            }, 500);
            
            console.log('Iniciando simulação com:', simulationData);
        });
        
        /* =============================================== */
        /* ========== MODAL DE SETUP - FIM ============= */
        /* =============================================== */

        // Menu toggle functionality
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const sidebarCloseBtn = document.getElementById('sidebarCloseBtn');
        const messagesArea = document.getElementById('messagesArea');
        const chatForm = document.getElementById('chatForm');
        const messageInput = document.getElementById('messageInput');
        const backHomeBtn = document.getElementById('backHomeBtn');

        const closeSidebar = () => {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
        };

        // Back to home button
        backHomeBtn.addEventListener('click', () => {
            window.location.href = '../html/homeLogin.html';
        });

        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
        });

        // Close sidebar when clicking on overlay
        sidebarOverlay.addEventListener('click', closeSidebar);

        // Close sidebar when clicking close button
        sidebarCloseBtn.addEventListener('click', closeSidebar);

        // Close sidebar when clicking on a chat item
        document.querySelectorAll('.chat-item').forEach(item => {
            item.addEventListener('click', closeSidebar);
        });

        // Function to add message to chat
        function addMessage(text, isUser, score = null, feedback = null) {
            // Remove empty state on first message
            if (messagesArea.querySelector('.empty-state')) {
                messagesArea.innerHTML = '';
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;

            let contentHTML = `
                <div class="message-content">
                    ${text}
                    ${score ? `<div class="message-score">Score: ${score} - ${feedback}</div>` : ''}
                </div>
                <div class="message-icon">
                    <i class="fas fa-${isUser ? 'user' : 'robot'}"></i>
                </div>
            `;

            if (isUser) {
                contentHTML = `
                    <div class="message-content">
                        ${text}
                    </div>
                    <div class="message-icon">
                        <i class="fas fa-user"></i>
                    </div>
                `;
            }

            messageDiv.innerHTML = contentHTML;
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // Handle form submission
        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = messageInput.value.trim();

            if (text) {
                addMessage(text, true);
                messageInput.value = '';

                // Simulate bot response
                setTimeout(() => {
                    addMessage('Ótima resposta! Você demonstrou um bom conhecimento. Agora vamos para a próxima pergunta...');
                }, 500);
            }
        });
    </script>
    <script src="script-chat.js"></script>
</body>

</html>